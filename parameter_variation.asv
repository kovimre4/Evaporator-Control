clear

y_final = [1.0 50.5 25.0];

% Initialise parameters
initialise_parameters

% Simulate
in = Simulink.SimulationInput('plant_master');
in = in.setVariable('rhoA', 20);
out = sim(in);

% Evaluate signals
t = out.tout;
y = out.yout;

error = y-y_final;
treshold = 0.01 * y_final;

settled = error <= treshold;

% Search for when the signal stays within the treshold
flip(settled, 1);